# DigitalOcean App Platform Specification
# For task-manager-test2-app

name: task-manager-test2-app
region: nyc

services:
- name: task-manager-api
  source_dir: /
  github:
    repo: RithishRamesh-dev/task-manager-test2-app-autodev
    branch: staging
    deploy_on_push: true
  
  # Use Procfile for command configuration
  
  # Environment configuration
  environment_slug: python
  instance_count: 1
  instance_size_slug: basic-xxs
  
  # Health check
  health_check:
    http_path: /health
    initial_delay_seconds: 30
    period_seconds: 10
    timeout_seconds: 5
    success_threshold: 1
    failure_threshold: 3
  
  # HTTP configuration
  http_port: 8080
  
  # Environment variables
  envs:
  - key: FLASK_ENV
    value: production
  - key: FLASK_APP
    value: app_socketio.py
  - key: PORT
    value: "8080"
  - key: PYTHONPATH
    value: /app
  - key: DATABASE_URL
    type: SECRET
    value: ${db.DATABASE_URL}
  - key: SECRET_KEY
    type: SECRET
    value: your-secret-key-here-change-in-production
  - key: JWT_SECRET_KEY  
    type: SECRET
    value: your-jwt-secret-key-here-change-in-production

# Database configuration
databases:
- name: db
  engine: PG
  cluster_name: task-manager-test2-db
  production: true